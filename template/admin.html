{% extends "layout.html" %}

{% block content %}
  <h2>Admin Dashboard</h2>

  <p><strong>Total Feedback Entries:</strong> {{ total }}</p>
  <p><strong>Average Rating:</strong> {{ avg_rating }} / 5</p>
  <form action="{{ url_for('export_csv') }}" method="get">
    <button type="submit">⬇️ Export Feedback as CSV</button>
  </form>


  {% if feedbacks %}
    <table border="1" cellpadding="10" cellspacing="0" style="width:100%; margin-top:20px;">
      <thead>
        <tr style="background-color:#f2f2f2;">
          <th>ID</th>
          <th>Name</th>
          <th>Email</th>
          <th>Rating</th>
          <th>Message</th>
        </tr>
      </thead>
      <tbody>
        {% for fb in feedbacks %}
        <tr>
          <td>{{ fb[0] }}</td>
          <td>{{ fb[1] or 'N/A' }}</td>
          <td>{{ fb[2] }}</td>
          <td>{{ fb[3] }}</td>
          <td>{{ fb[4] }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    
  {% else %}
    <p>No feedback entries yet.</p>
  {% endif %}
{% endblock %}

